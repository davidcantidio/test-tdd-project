--- a/audit_intelligent.sh
+++ b/audit_intelligent.sh
@@ -1,10 +1,67 @@
 #!/bin/bash
 # ðŸ§  AUDIT SCRIPT INTELIGENTE - Auditoria Extensiva com Real LLM Analysis
 # 
 # Baseado na infraestrutura de agentes inteligentes testada e validada
 # Realiza auditoria semÃ¢ntica profunda de todo o projeto
 
-set -euo pipefail
+set -euo pipefail
+shopt -s lastpipe
+export LC_ALL=C.UTF-8
+umask 077
+
+## -------------------------
+## Flags & helpers
+## -------------------------
+VERBOSE=0
+KEEP=0
+LIMIT=""
+
+usage() {
+  cat <<'USAGE'
+Uso: ./audit_intelligent.sh [opÃ§Ãµes]
+  --verbose          Liga modo verboso (set -x)
+  --keep             NÃ£o apaga .audit_intelligent antes de rodar
+  --limit N          Limita a anÃ¡lise a N arquivos prioritÃ¡rios (propagado aos blocos python)
+  -h|--help          Mostra esta ajuda
+USAGE
+}
+
+die() { echo "âŒ ERRO: $*" >&2; exit 1; }
+info(){ printf '%s\n' "$*"; }
+
+on_err() {
+  local lineno=$1
+  echo "ðŸ’¥ Falha na linha ${lineno}. Consulte os artefatos em ${AUDIT_DIR}/ (se jÃ¡ criados)." >&2
+}
+trap 'on_err $LINENO' ERR
+set -o errtrace
+
+while [[ $# -gt 0 ]]; do
+  case "$1" in
+    --verbose) VERBOSE=1; shift ;;
+    --keep)    KEEP=1;    shift ;;
+    --limit)   LIMIT="${2:-}"; [[ -n "${LIMIT}" ]] || die "--limit requer um valor"; shift 2 ;;
+    -h|--help) usage; exit 0 ;;
+    *) die "OpÃ§Ã£o invÃ¡lida: $1";;
+  esac
+done
+
+if [[ ${VERBOSE} -eq 1 ]]; then
+  set -x
+fi
+
+command -v python3 >/dev/null 2>&1 || die "python3 nÃ£o encontrado no PATH"
 
 # ConfiguraÃ§Ã£o
 AUDIT_DIR=".audit_intelligent"
 PROJECT_ROOT="."
 TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
 REPORT_FILE="${AUDIT_DIR}/intelligent_audit_report_${TIMESTAMP}.md"
 
-echo "ðŸ§  Iniciando AUDITORIA INTELIGENTE EXTENSIVA..."
-echo "ðŸ“… Timestamp: ${TIMESTAMP}"
+run_step() {
+  # Uso: run_step "DescriÃ§Ã£o" comando...
+  local desc="$1"; shift
+  info "â–¶ï¸  ${desc}"
+  "$@"
+  local rc=$?
+  info "âœ… ${desc} (rc=${rc})"
+}
+
+echo "ðŸ§  Iniciando AUDITORIA INTELIGENTE EXTENSIVAâ€¦"
+echo "ðŸ“… Timestamp: ${TIMESTAMP}"
@@ -16,9 +73,20 @@
 
 # Limpar e criar diretÃ³rio de auditoria
-rm -rf "${AUDIT_DIR}"
-mkdir -p "${AUDIT_DIR}"/{reports,analysis,recommendations,performance}
+if [[ ${KEEP} -eq 0 ]]; then
+  # Defesa adicional: garanta que a var nÃ£o estÃ¡ vazia
+  [[ -n "${AUDIT_DIR}" && "${AUDIT_DIR}" != "/" ]] || die "AUDIT_DIR invÃ¡lido"
+  rm -rf -- "${AUDIT_DIR}"
+fi
+mkdir -p -- "${AUDIT_DIR}"/{reports,analysis,recommendations,performance}
+
+# Registrar meta-informaÃ§Ãµes da execuÃ§Ã£o
+{
+  echo "timestamp=${TIMESTAMP}"
+  echo "project_root=${PROJECT_ROOT}"
+  echo "keep=${KEEP}"
+  echo "limit=${LIMIT}"
+  python3 --version 2>&1 | sed 's/^/python_version=/'
+} > "${AUDIT_DIR}/run.meta"
 
 # Banner de inÃ­cio
 cat > "${REPORT_FILE}" << 'EOF'
@@ -34,6 +102,20 @@
 **Agentes:** 5 agentes inteligentes + context integration  
 
 EOF
+
+# Helper para injetar LIMIT para os blocos Python (via variÃ¡vel de ambiente)
+export AI_AUDIT_LIMIT="${LIMIT}"
+
+# Pequeno wrapper para rodar blocos Python com padronizaÃ§Ã£o de log
+pyblock() { python3 - "$@"; }
+
+## Exemplo de uso uniformizado
+## run_step "Fase 1: InventÃ¡rio Completo do Sistema" \
+##   pyblock <<'EOF'
+##   # cÃ³digo pythonâ€¦
+## EOF
+
+echo "ðŸ“Š Executando anÃ¡lise de inventÃ¡rio completo..."
 
 # 1. INVENTÃRIO COMPLETO DO PROJETO
-echo "ðŸ” Fase 1: InventÃ¡rio Completo do Sistema"
+echo "ðŸ” Fase 1: InventÃ¡rio Completo do Sistema"
